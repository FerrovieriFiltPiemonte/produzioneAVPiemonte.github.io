<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Estivo 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
        }

        .logo-container img {
            max-width: 120px;
            height: auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin: 0 0 10px 0;
            font-size: 2em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: 700;
        }

        .subtitle {
            text-align: center;
            color: white;
            font-size: 0.95em;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            font-style: italic;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5em;
            }

            .logo-container img {
                max-width: 100px;
            }

            .subtitle {
                font-size: 0.85em;
            }

            /* Menu ottimizzato per tablet/mobile */
            .menu-bar {
                flex-direction: column;
                gap: 20px;
            }

            .menu-section {
                display: flex;
                flex-direction: column;
                gap: 8px;
            }

            .menu-bar label {
                margin-right: 0;
                font-weight: 700;
            }

            .menu-bar select {
                min-width: 100%;
                width: 100%;
                padding: 12px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.2em;
            }

            .logo-container img {
                max-width: 80px;
            }

            .subtitle {
                font-size: 0.75em;
            }

            .menu-bar {
                flex-direction: column;
                gap: 15px;
            }

            .menu-bar select {
                min-width: 100%;
                width: 100%;
            }

            .calendar-table td {
                padding: 8px;
                min-height: 50px;
                font-size: 0.9em;
            }

            .calendar-table th {
                padding: 8px;
                font-size: 0.85em;
            }
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .month-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .month-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .month-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.8em;
            font-weight: bold;
        }

        .calendar-table {
            width: 100%;
            border-collapse: collapse;
            padding: 20px;
            table-layout: fixed;
        }

        .calendar-table thead {
            background-color: #f5f5f5;
        }

        .calendar-table th {
            padding: 12px;
            text-align: center;
            font-weight: 600;
            color: #667eea;
            border-bottom: 2px solid #e0e0e0;
            width: calc(100% / 7);
        }

        .calendar-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
            min-height: 60px;
            font-size: 1.1em;
            background-color: white;
            width: calc(100% / 7);
        }

        .calendar-table td:hover {
            background-color: #f0f0f0;
            cursor: pointer;
        }

        .calendar-table td.empty {
            background-color: #fafafa;
            color: #ccc;
        }

        .calendar-table td.empty:hover {
            background-color: #fafafa;
            cursor: default;
        }

        .calendar-table td.weekend {
            background-color: #fffacd;
        }

        .menu-bar {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            gap: 40px;
            align-items: center;
            flex-wrap: wrap;
        }

        .menu-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .menu-bar label {
            font-weight: 600;
            color: #667eea;
            margin-right: 15px;
            font-size: 1.1em;
        }

        .menu-bar select {
            padding: 10px 15px;
            font-size: 1em;
            border: 2px solid #667eea;
            border-radius: 5px;
            background-color: white;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 350px;
        }

        .menu-bar select:hover {
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .menu-bar select:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .calendar-table td.period-fill {
            color: white;
            font-weight: bold;
        }

        .calendar-table td.periodo-1 {
            background-color: #8b7b9a;
        }

        .calendar-table td.periodo-1:hover {
            background-color: #7a6a89;
        }

        .calendar-table td.periodo-2 {
            background-color: #7a9b9a;
        }

        .calendar-table td.periodo-2:hover {
            background-color: #698a89;
        }

        .calendar-table td.periodo-3 {
            background-color: #9a8b6b;
        }

        .calendar-table td.periodo-3:hover {
            background-color: #897a5a;
        }

        .calendar-table td.periodo-4 {
            background-color: #8a7a6b;
        }

        .calendar-table td.periodo-4:hover {
            background-color: #79695a;
        }

        .calendar-table td.periodo-5 {
            background-color: #6b8b9a;
        }

        .calendar-table td.periodo-5:hover {
            background-color: #5a7a89;
        }

        .calendar-table td.periodo-6 {
            background-color: #9a7a8b;
        }

        .calendar-table td.periodo-6:hover {
            background-color: #89697a;
        }

        .calendar-table td.riposo {
            background-color: #00a878;
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo:hover {
            background-color: #008a63;
        }

        .calendar-table td.riposo-split-periodo1 {
            background: linear-gradient(to bottom, #8b7b9a 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo-split-periodo2 {
            background: linear-gradient(to bottom, #7a9b9a 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo-split-periodo3 {
            background: linear-gradient(to bottom, #9a8b6b 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo-split-periodo4 {
            background: linear-gradient(to bottom, #8a7a6b 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo-split-periodo5 {
            background: linear-gradient(to bottom, #6b8b9a 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.riposo-split-periodo6 {
            background: linear-gradient(to bottom, #9a7a8b 50%, #00a878 50%);
            color: white;
            font-weight: bold;
        }
        
        .calendar-table td.intervallo-split-periodo1 {
            background: linear-gradient(to bottom, #8b7b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo2 {
            background: linear-gradient(to bottom, #7a9b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo3 {
            background: linear-gradient(to bottom, #9a8b6b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo4 {
            background: linear-gradient(to bottom, #8a7a6b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo5 {
            background: linear-gradient(to bottom, #6b8b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo6 {
            background: linear-gradient(to bottom, #9a7a8b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

.calendar-table td.intervallo {
            background-color: #5dade2;
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo:hover {
            background-color: #3498db;
        }

        .calendar-table td.intervallo-split-periodo1 {
            background: linear-gradient(to bottom, #8b7b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo2 {
            background: linear-gradient(to bottom, #7a9b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo3 {
            background: linear-gradient(to bottom, #9a8b6b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo4 {
            background: linear-gradient(to bottom, #8a7a6b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo5 {
            background: linear-gradient(to bottom, #6b8b9a 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }

        .calendar-table td.intervallo-split-periodo6 {
            background: linear-gradient(to bottom, #9a7a8b 50%, #5dade2 50%);
            color: white;
            font-weight: bold;
        }
        .info-note {
            background-color: rgba(255, 255, 255, 0.95);
            border-left: 4px solid #FF8C00;
            padding: 15px 20px;
            margin: 20px auto;
            max-width: 1200px;
            border-radius: 5px;
            font-weight: 600;
            color: #333;
            font-size: 0.95em;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

    </style>
</head>
<body>
    <div class="container">



            <div class="logo-container">
                <img src="logo.png" alt="Logo Filt CGIL" title="Filt CGIL Piemonte">
            </div>
            <h1>Visualizzatore grafico proposta ferie estive AV Piemonte</h1>
            <p class="subtitle">Powered by Filt CGIL Piemonte - Versione 1.0 del 25-02-2026</p>
        </div>

        <div class="menu-bar">
            <div class="menu-section">
                <label for="periodSelect">Seleziona Periodo:</label>
                <select id="periodSelect">
                    <option value="">-- Nessuno --</option>
                    <option value="periodo1">Periodo 1: 10 giugno - 26 giugno</option>
                    <option value="periodo2">Periodo 2: 27 giugno - 13 luglio</option>
                    <option value="periodo3">Periodo 3: 14 luglio - 30 luglio</option>
                    <option value="periodo4">Periodo 4: 31 luglio - 16 agosto</option>
                    <option value="periodo5">Periodo 5: 17 agosto - 2 settembre</option>
                    <option value="periodo6">Periodo 6: 03 settembre - 19 settembre</option>
                    <option value="tutti">üìÖ Tutti i Periodi</option>
                </select>
            </div>

            <div class="menu-section">
                <label for="riposoSelect">Seleziona Riposo:</label>
                <select id="riposoSelect">
                    <option value="">-- Nessuno --</option>
                    <option value="">-- Nessuno --</option>
                    <option value="riposo1">Riposo 1 - 9 giugno intervallo 1 10 giugno</option>
                    <option value="riposo2">Riposo 2 - 10 giugno intervallo 2 11 giugno</option>
                    <option value="riposo3">Riposo 3 - 11 giugno intervallo 3 12 giugno</option>
                    <option value="riposo4">Riposo 4 - 12 giugno intervallo 4 13 giugno</option>
                    <option value="riposo5">Riposo 5 - 13 giugno intervallo 5 14 giugno</option>
                    <option value="riposo6">Riposo 6 - 14 giugno intervallo 6 15 giugno</option>
                    <option value="intervallo1">Intervallo 1 - 8 giugno riposo 1 9 giugno</option>
                    <option value="intervallo2">Intervallo 2 - 9 giugno riposo 2 10 giugno</option>
                    <option value="intervallo3">Intervallo 3 - 10 giugno riposo 3 11 giugno</option>
                    <option value="intervallo4">Intervallo 4 - 11 giugno riposo 4 12 giugno</option>
                    <option value="intervallo5">Intervallo 5 - 12 giugno riposo 5 13 giugno</option>
                    <option value="intervallo6">Intervallo 6 - 13 giugno riposo 6 14 giugno</option>
                </select>
            </div>

            <div class="menu-section">

            </div>
        </div>

        </div>

        <div class="info-note">
            <strong>NB:</strong> La griglia dei riposi √® fissa e lo schema non pu√≤ variare.<br>Gli intervalli possono essere fissati nel giorno antecedente o seguente durante il roster (produzione del turno individuale).<br>Per semplicit√† abbiamo previsto due casi: tutti gli intervalli prima o tutti gli intervalli dopo il riposo.<br>Il senso della cadenza dei riposi e dell'interferenza con le ferie estive dovrebbe in ogni caso essere chiaro.
        </div>

        <div class="calendar-grid" id="calendarGrid"></div>
    </div>

    <script>
        const months = [
            { name: 'Giugno', month: 5, year: 2026, emoji: 'üåû' },
            { name: 'Luglio', month: 6, year: 2026, emoji: '‚òÄÔ∏è' },
            { name: 'Agosto', month: 7, year: 2026, emoji: 'üèñÔ∏è' },
            { name: 'Settembre', month: 8, year: 2026, emoji: 'üçÇ' }
        ];

        const dayNames = ['Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab', 'Dom'];

        function getDaysInMonth(month, year) {
            return new Date(year, month + 1, 0).getDate();
        }

        function getFirstDayOfMonth(month, year) {
            const day = new Date(year, month, 1).getDay();
            return (day + 6) % 7;
        }

        function isWeekend(dayOfWeek) {
            return dayOfWeek === 5 || dayOfWeek === 6;
        }

        function generatePeriodDays() {
            const periods = {
                periodo1: [],
                periodo2: [],
                periodo3: [],
                periodo4: [],
                periodo5: [],
                periodo6: []
            };

            let date = new Date(2026, 5, 10);
            while (date <= new Date(2026, 5, 26)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo1.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            date = new Date(2026, 5, 27);
            while (date <= new Date(2026, 6, 13)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo2.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            date = new Date(2026, 6, 14);
            while (date <= new Date(2026, 6, 30)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo3.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            date = new Date(2026, 6, 31);
            while (date <= new Date(2026, 7, 16)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo4.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            date = new Date(2026, 7, 17);
            while (date <= new Date(2026, 8, 2)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo5.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            date = new Date(2026, 8, 3);
            while (date <= new Date(2026, 8, 19)) {
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                periods.periodo6.push(`2026-${month}-${day}`);
                date.setDate(date.getDate() + 1);
            }

            return periods;
        }

        const periods = generatePeriodDays();

        function generateRipasoDays() {
            const riposi = {
                riposo1: { riposo: [], intervallo: [] },
                riposo2: { riposo: [], intervallo: [] },
                riposo3: { riposo: [], intervallo: [] },
                riposo4: { riposo: [], intervallo: [] },
                riposo5: { riposo: [], intervallo: [] },
                riposo6: { riposo: [], intervallo: [] },
                intervallo1: { intervallo: [], riposo: [] },
                intervallo2: { intervallo: [], riposo: [] },
                intervallo3: { intervallo: [], riposo: [] },
                intervallo4: { intervallo: [], riposo: [] },
                intervallo5: { intervallo: [], riposo: [] },
                intervallo6: { intervallo: [], riposo: [] }
            };

            const startDates = {
                riposo1: new Date(2026, 5, 9),
                riposo2: new Date(2026, 5, 10),
                riposo3: new Date(2026, 5, 11),
                riposo4: new Date(2026, 5, 12),
                riposo5: new Date(2026, 5, 13),
                riposo6: new Date(2026, 5, 14)
            };

            Object.entries(startDates).forEach(([riposoKey, startDate]) => {
                const riposoDatesList = [];
                const intervalloDatesList = [];

                // Vai indietro fino all'inizio di giugno
                let dateIndietro = new Date(startDate);
                while (dateIndietro.getDate() >= 1 && dateIndietro.getMonth() === 5) {
                    dateIndietro.setDate(dateIndietro.getDate() - 6);
                    if (dateIndietro.getMonth() === 5 && dateIndietro.getDate() >= 1) {
                        const month = String(dateIndietro.getMonth() + 1).padStart(2, '0');
                        const day = String(dateIndietro.getDate()).padStart(2, '0');
                        riposoDatesList.unshift(`2026-${month}-${day}`);
                        
                        // Intervallo is day after riposo
                        const nextDay = new Date(dateIndietro);
                        nextDay.setDate(nextDay.getDate() + 1);
                        const monthIntervallo = String(nextDay.getMonth() + 1).padStart(2, '0');
                        const dayIntervallo = String(nextDay.getDate()).padStart(2, '0');
                        intervalloDatesList.unshift(`2026-${monthIntervallo}-${dayIntervallo}`);
                    }
                }

                // Aggiungi la data di partenza e il giorno di intervallo
                const month = String(startDate.getMonth() + 1).padStart(2, '0');
                const day = String(startDate.getDate()).padStart(2, '0');
                riposoDatesList.push(`2026-${month}-${day}`);
                
                const nextDay = new Date(startDate);
                nextDay.setDate(nextDay.getDate() + 1);
                const monthIntervallo = String(nextDay.getMonth() + 1).padStart(2, '0');
                const dayIntervallo = String(nextDay.getDate()).padStart(2, '0');
                intervalloDatesList.push(`2026-${monthIntervallo}-${dayIntervallo}`);

                // Vai in avanti fino alla fine di settembre
                let dateAvanti = new Date(startDate);
                while (dateAvanti.getMonth() <= 8) {
                    dateAvanti.setDate(dateAvanti.getDate() + 6);
                    if (dateAvanti.getMonth() <= 8) {
                        const month = String(dateAvanti.getMonth() + 1).padStart(2, '0');
                        const day = String(dateAvanti.getDate()).padStart(2, '0');
                        riposoDatesList.push(`2026-${month}-${day}`);
                        
                        // Intervallo is day after riposo
                        const nextDay = new Date(dateAvanti);
                        nextDay.setDate(nextDay.getDate() + 1);
                        const monthIntervallo = String(nextDay.getMonth() + 1).padStart(2, '0');
                        const dayIntervallo = String(nextDay.getDate()).padStart(2, '0');
                        intervalloDatesList.push(`2026-${monthIntervallo}-${dayIntervallo}`);
                    }
                }

                riposi[riposoKey].riposo = riposoDatesList;
                riposi[riposoKey].intervallo = intervalloDatesList;
            });

            // Generate inverse variant: Intervallo PRIMA, Riposo DOPO
            Object.entries(startDates).forEach(([riposoKey, startDate]) => {
                const intervalloKey = riposoKey.replace('riposo', 'intervallo');
                const intervalloDatesList = [];
                const riposoDatesList = [];

                // Vai indietro fino all'inizio di giugno
                let dateIndietro = new Date(startDate);
                while (dateIndietro.getDate() >= 1 && dateIndietro.getMonth() === 5) {
                    dateIndietro.setDate(dateIndietro.getDate() - 6);
                    if (dateIndietro.getMonth() === 5 && dateIndietro.getDate() >= 1) {
                        // Intervallo is day before riposo
                        const dayBefore = new Date(dateIndietro);
                        dayBefore.setDate(dayBefore.getDate() - 1);
                        const monthIntervallo = String(dayBefore.getMonth() + 1).padStart(2, '0');
                        const dayIntervallo = String(dayBefore.getDate()).padStart(2, '0');
                        intervalloDatesList.unshift(`2026-${monthIntervallo}-${dayIntervallo}`);

                        // Riposo is the original date
                        const month = String(dateIndietro.getMonth() + 1).padStart(2, '0');
                        const day = String(dateIndietro.getDate()).padStart(2, '0');
                        riposoDatesList.unshift(`2026-${month}-${day}`);
                    }
                }

                // Aggiungi la data di partenza con intervallo prima
                const dayBefore = new Date(startDate);
                dayBefore.setDate(dayBefore.getDate() - 1);
                const monthIntervallo = String(dayBefore.getMonth() + 1).padStart(2, '0');
                const dayIntervallo = String(dayBefore.getDate()).padStart(2, '0');
                intervalloDatesList.push(`2026-${monthIntervallo}-${dayIntervallo}`);

                const month = String(startDate.getMonth() + 1).padStart(2, '0');
                const day = String(startDate.getDate()).padStart(2, '0');
                riposoDatesList.push(`2026-${month}-${day}`);

                // Vai in avanti fino alla fine di settembre
                let dateAvanti = new Date(startDate);
                while (dateAvanti.getMonth() <= 8) {
                    dateAvanti.setDate(dateAvanti.getDate() + 6);
                    if (dateAvanti.getMonth() <= 8) {
                        // Intervallo is day before riposo
                        const dayBefore = new Date(dateAvanti);
                        dayBefore.setDate(dayBefore.getDate() - 1);
                        const monthIntervallo = String(dayBefore.getMonth() + 1).padStart(2, '0');
                        const dayIntervallo = String(dayBefore.getDate()).padStart(2, '0');
                        intervalloDatesList.push(`2026-${monthIntervallo}-${dayIntervallo}`);

                        // Riposo is the original date
                        const month = String(dateAvanti.getMonth() + 1).padStart(2, '0');
                        const day = String(dateAvanti.getDate()).padStart(2, '0');
                        riposoDatesList.push(`2026-${month}-${day}`);
                    }
                }

                riposi[intervalloKey].intervallo = intervalloDatesList;
                riposi[intervalloKey].riposo = riposoDatesList;
            });

            return riposi;
        }

        const riposi = generateRipasoDays();

        function createMonthCard(monthData) {
            const { name, month, year, emoji } = monthData;
            const daysInMonth = getDaysInMonth(month, year);
            const firstDay = getFirstDayOfMonth(month, year);

            let html = `
                <div class="month-card">
                    <div class="month-header">${emoji} ${name} ${year}</div>
                    <table class="calendar-table">
                        <thead>
                            <tr>
            `;

            dayNames.forEach(day => {
                html += `<th>${day}</th>`;
            });

            html += `
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
            `;

            for (let i = 0; i < firstDay; i++) {
                html += `<td class="empty"></td>`;
            }

            let dayOfWeek = firstDay;
            for (let day = 1; day <= daysInMonth; day++) {
                const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                let classes = '';

                if (isWeekend(dayOfWeek)) {
                    classes = 'weekend';
                }

                html += `<td class="${classes}" data-date="${dateString}" data-original-class="${classes}" data-original-content="${day}">${day}</td>`;

                dayOfWeek++;
                if (dayOfWeek === 7) {
                    html += `</tr><tr>`;
                    dayOfWeek = 0;
                }
            }

            if (dayOfWeek !== 0) {
                while (dayOfWeek < 7) {
                    html += `<td class="empty"></td>`;
                    dayOfWeek++;
                }
            }

            html += `
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            return html;
        }

        const calendarGrid = document.getElementById('calendarGrid');
        months.forEach(month => {
            calendarGrid.innerHTML += createMonthCard(month);
        });

        function clearPeriodColors() {
            document.querySelectorAll('[data-date]').forEach(cell => {
                cell.classList.remove('periodo-1', 'periodo-2', 'periodo-3', 'periodo-4', 'periodo-5', 'periodo-6', 'period-fill');
                const originalClass = cell.getAttribute('data-original-class');
                cell.className = originalClass;
                cell.style.backgroundColor = '';
                cell.style.color = '';
            });
        }

        function applyPeriodColor(periodKey) {
            document.querySelectorAll('[data-date]').forEach(cell => {
                const originalClass = cell.getAttribute('data-original-class');
                const originalContent = cell.getAttribute('data-original-content');
                cell.className = originalClass;
                cell.innerHTML = originalContent;
                cell.style.backgroundColor = '';
            });

            const datesInPeriod = periods[periodKey];
            const colors = {
                periodo1: '#8b7b9a',
                periodo2: '#7a9b9a',
                periodo3: '#9a8b6b',
                periodo4: '#8a7a6b',
                periodo5: '#6b8b9a',
                periodo6: '#9a7a8b'
            };

            const periodNumber = periodKey.replace('periodo', '');
            datesInPeriod.forEach(dateString => {
                const cell = document.querySelector(`[data-date="${dateString}"]`);
                if (cell) {
                    const originalContent = cell.getAttribute('data-original-content');
                    cell.className = '';
                    cell.classList.add(periodKey, 'period-fill');
                    cell.style.backgroundColor = colors[periodKey];
                    cell.style.color = 'white';
                    cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">FERIE<br>Periodo ${periodNumber}</small>`;
                }
            });
        }

        function applyAllPeriodColors() {
            document.querySelectorAll('[data-date]').forEach(cell => {
                const originalClass = cell.getAttribute('data-original-class');
                const originalContent = cell.getAttribute('data-original-content');
                cell.className = originalClass;
                cell.innerHTML = originalContent;
                cell.style.backgroundColor = '';
            });

            const colors = {
                periodo1: '#8b7b9a',
                periodo2: '#7a9b9a',
                periodo3: '#9a8b6b',
                periodo4: '#8a7a6b',
                periodo5: '#6b8b9a',
                periodo6: '#9a7a8b'
            };

            Object.entries(periods).forEach(([periodKey, dates]) => {
                const periodNumber = periodKey.replace('periodo', '');
                dates.forEach(dateString => {
                    const cell = document.querySelector(`[data-date="${dateString}"]`);
                    if (cell) {
                        const originalContent = cell.getAttribute('data-original-content');
                        cell.className = '';
                        cell.classList.add(periodKey, 'period-fill');
                        cell.style.backgroundColor = colors[periodKey];
                        cell.style.color = 'white';
                        cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">FERIE<br>Periodo ${periodNumber}</small>`;
                    }
                });
            });
        }

        let currentRiposoSelection = '';

        function applyRiposoColor(riposoKey) {
            const riposoData = riposi[riposoKey];
            const datesInRiposo = riposoData.riposo;
            const datesInIntervallo = riposoData.intervallo;
            const currentPeriodoSelection = document.getElementById('periodSelect').value;

            // Apply riposo color
            datesInRiposo.forEach(dateString => {
                const cell = document.querySelector(`[data-date="${dateString}"]`);
                if (cell) {
                    const originalContent = cell.getAttribute('data-original-content');
                    if (currentPeriodoSelection && currentPeriodoSelection !== '' && currentPeriodoSelection !== 'tutti') {
                        const datesInPeriod = periods[currentPeriodoSelection];
                        if (datesInPeriod.includes(dateString)) {
                            cell.className = '';
                            cell.classList.add(`riposo-split-${currentPeriodoSelection}`);
                            cell.style.backgroundColor = '';
                            cell.style.color = '';
                            cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">RIPOSO</small>`;
                            return;
                        }
                    } else if (currentPeriodoSelection === 'tutti') {
                        let foundPeriodo = null;
                        Object.entries(periods).forEach(([periodKey, dates]) => {
                            if (dates.includes(dateString)) {
                                foundPeriodo = periodKey;
                            }
                        });
                        if (foundPeriodo) {
                            cell.className = '';
                            cell.classList.add(`riposo-split-${foundPeriodo}`);
                            cell.style.backgroundColor = '';
                            cell.style.color = '';
                            cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">RIPOSO</small>`;
                            return;
                        }
                    }
                    cell.className = '';
                    cell.classList.add('riposo');
                    cell.style.backgroundColor = '';
                    cell.style.color = '';
                    cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">RIPOSO</small>`;
                }
            });

            // Apply intervallo color
            datesInIntervallo.forEach(dateString => {
                const cell = document.querySelector(`[data-date="${dateString}"]`);
                if (cell) {
                    const originalContent = cell.getAttribute('data-original-content');
                    if (currentPeriodoSelection && currentPeriodoSelection !== '' && currentPeriodoSelection !== 'tutti') {
                        const datesInPeriod = periods[currentPeriodoSelection];
                        if (datesInPeriod.includes(dateString)) {
                            cell.className = '';
                            cell.classList.add(`intervallo-split-${currentPeriodoSelection}`);
                            cell.style.backgroundColor = '';
                            cell.style.color = '';
                            cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">INTERVALLO</small>`;
                            return;
                        }
                    } else if (currentPeriodoSelection === 'tutti') {
                        let foundPeriodo = null;
                        Object.entries(periods).forEach(([periodKey, dates]) => {
                            if (dates.includes(dateString)) {
                                foundPeriodo = periodKey;
                            }
                        });
                        if (foundPeriodo) {
                            cell.className = '';
                            cell.classList.add(`intervallo-split-${foundPeriodo}`);
                            cell.style.backgroundColor = '';
                            cell.style.color = '';
                            cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">INTERVALLO</small>`;
                            return;
                        }
                    }
                    cell.className = '';
                    cell.classList.add('intervallo');
                    cell.style.backgroundColor = '';
                    cell.style.color = '';
                    cell.innerHTML = `${originalContent}<br><small style="font-size: 0.7em;">INTERVALLO</small>`;
                }
            });
        }

        function refreshDisplay() {
            const selectedPeriodo = document.getElementById('periodSelect').value;
            const selectedRiposo = document.getElementById('riposoSelect').value;

            document.querySelectorAll('[data-date]').forEach(cell => {
                const originalClass = cell.getAttribute('data-original-class');
                const originalContent = cell.getAttribute('data-original-content');
                cell.className = originalClass;
                cell.innerHTML = originalContent;
                cell.style.backgroundColor = '';
                cell.style.color = '';
            });

            if (selectedPeriodo === 'tutti') {
                applyAllPeriodColors();
            } else if (selectedPeriodo !== '') {
                applyPeriodColor(selectedPeriodo);
            }

            if (selectedRiposo !== '') {
                applyRiposoColor(selectedRiposo);
            }
        }

        document.getElementById('periodSelect').value = '';
        document.getElementById('riposoSelect').value = '';
        clearPeriodColors();

        document.getElementById('periodSelect').addEventListener('change', function() {
            refreshDisplay();
        });

        document.getElementById('riposoSelect').addEventListener('change', function() {
            currentRiposoSelection = this.value;
            refreshDisplay();
        });

        document.querySelectorAll('[data-date]').forEach(cell => {
            cell.addEventListener('click', function() {
                const date = this.getAttribute('data-date');
                console.log('Data selezionata:', date);
                alert(`Data selezionata: ${date}`);
            });
        });
    </script>
</body>
</html>
